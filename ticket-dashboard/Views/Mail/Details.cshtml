@model ticket_dashboard.Models.MailDetailModel

@{
    ViewData["Title"] = "Mail-Details";
}

<h1>E-Mail-Details: @Model.Subject</h1>

<div class="card mb-4">
    <div class="card-header">
        <strong>Von:</strong> @Model.Sender<br />
        <strong>Datum:</strong> @Model.Date.LocalDateTime.ToString("g")
    </div>
    <div class="card-body">
        <h4>Nachrichtentext:</h4>

        @if (!string.IsNullOrWhiteSpace(Model.Body))
        {


            <iframe src="@Url.Action("Body", "Mail", new { uid = Model.Uid.Id })"
                    style="width: 100%; height: 600px; border: 1px solid #ccc; background-color: white;">
            </iframe>


            <p class="mt-3 text-muted">Die E-Mail wird in einem Iframe gerendert.</p>

        }
        else
        {
            <div class="alert alert-info">Die E-Mail enthält keinen auslesbaren Inhalt.</div>
        }
    </div>
</div>

<h2>Aktion</h2>
<div class="alert alert-warning">
    ACHTUNG: Beim Klick auf "Selbst zuweisen" wird die E-Mail sofort als Ticket erstellt und im Postfach verschoben.
</div>

<form asp-controller="Mail" asp-action="Assign" method="post" class="mt-3">
    <input type="hidden" name="Uid" value="@Model.Uid.Id" />
    <input type="hidden" name="Sender" value="@Model.Sender" />
    <input type="hidden" name="Subject" value="@Model.Subject" />

    <input type="hidden" name="Body" value="@Model.Body" />

    @Html.AntiForgeryToken()

    <button type="submit" class="btn btn-lg btn-success">
        <i class="fas fa-ticket-alt"></i> Ticket erstellen und Selbst zuweisen
    </button>
    <a asp-action="Index" class="btn btn-secondary ml-3">Zurück zur Übersicht</a>
</form>